<Popup  x:Class="Views.ChannelSettingsView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"

        PlacementTarget="{Binding ElementName=PopupAnchor}"
        Placement="Center"
        StaysOpen="False"
        IsOpen="{Binding Path=ChannelSettings.IsChangingSettings}">
    <Border BorderBrush="{StaticResource HighlightBrush}"
            BorderThickness="2"
            Background="{StaticResource BackgroundBrush}">
        <WrapPanel Orientation="Vertical"
                    Margin="10">
            <TextBlock Foreground="{StaticResource ForegroundBrush}"
                        FontSize="20"
                        HorizontalAlignment="Center"
                        Margin="10,0">
                    <Run Text="{Binding Path=Model.Title}"/>
                    <Run Text="Channel Settings" />
            </TextBlock>
                
            <StackPanel TextBlock.Foreground="{StaticResource ForegroundBrush}"
                        Margin="10">
                <CheckBox IsChecked="{Binding Path=ChannelSettings.LoggingEnabled}">Automatically log each message</CheckBox>
                <CheckBox IsChecked="{Binding Path=ChannelSettings.ShouldFlash}">Channel flashes on a new message</CheckBox>
                
                <WrapPanel Visibility="{Binding Path=ChannelSettings.ShouldFlash, Converter={StaticResource BoolConverter}}"
                            TextBlock.Foreground="{StaticResource ForegroundBrush}">
                    <TextBlock Text="Flash every "
                                Margin="5"/>
                    <TextBox Text="{Binding Path=ChannelSettings.FlashInterval}"
                                VerticalAlignment="Center"
                                FontSize="12"/>
                    <TextBlock Text="New unread Messages"
                                Margin="5"/>
                </WrapPanel>
                
                <CheckBox IsChecked="{Binding Path=ChannelSettings.ShouldDing}">Play a sound and notify on new message</CheckBox>
                
                <StackPanel Visibility="{Binding Path=ShowAllSettings, Mode=OneWay, Converter={StaticResource BoolConverter}}">
                    <CheckBox IsChecked="{Binding Path=ChannelSettings.NotifyCharacterMention}">Notify me when this this character is mentioned</CheckBox>
                    <CheckBox IsChecked="{Binding Path=ChannelSettings.NotifyModPromoteDemote}">Create a notification when a moderator is promoted or demoted</CheckBox>
                    <CheckBox IsChecked="{Binding Path=ChannelSettings.NotifyOnJoinLeave}">Create a notification when a character joins or leaves</CheckBox>
                    <CheckBox IsChecked="{Binding Path=ChannelSettings.NotifyOnNormalJoinLeave}"
                              Margin="20,0"
                              Visibility="{Binding Path=ChannelSettings.NotifyOnJoinLeave, Mode=OneWay, Converter={StaticResource BoolConverter}}"
                              Content="Include users with no relationship to this character"/>
                </StackPanel>
                
                <TextBlock Margin="0,10">Notify me when these terms are mentioned (seperate with commas):</TextBlock>
                
                <TextBox Text="{Binding Path=ChannelSettings.NotifyTerms, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                            FontSize="12"/>
                
                <StackPanel Margin="20,0"
                            Visibility="{Binding Path=HasNotifyTerms, Mode=OneWay, Converter={StaticResource BoolConverter}}">
                    <CheckBox IsChecked="{Binding Path=ChannelSettings.NotifyOnWholeWordsOnly}"
                                IsEnabled="False"
                                >Only notify on whole words</CheckBox>
                
                    <CheckBox IsChecked="{Binding Path=ChannelSettings.NotifyIncludesCharacterNames}"
                                >Notify when the terms are in character names</CheckBox>
                
                    <CheckBox IsChecked="{Binding Path=ChannelSettings.NotifyIncludesMessages}"
                                >Notify when the terms are in messages</CheckBox>
                    <CheckBox IsChecked="{Binding Path=ChannelSettings.IgnoreNotInterested}"
                              >Do not notify for characters marked as not interested</CheckBox>
                </StackPanel>    
            </StackPanel>

            <Button Content="Close Settings"
                    Margin="10,5"
                    Foreground="{StaticResource ForegroundBrush}"
                    Command="{Binding Path=ChannelSettings.OpenChannelSettingsCommand}"/>
        </WrapPanel>
    </Border>
</Popup>
